<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>ATP ‚Äì Annual Training Program 2026</title>

<!-- Bootstrap 5 -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- Bootstrap Icons -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">

<style>
body {
  background: linear-gradient(135deg, #eef4f2, #f9fbfc);
  font-family: "Segoe UI", sans-serif;
}

.card {
  border-radius: 20px;
}

.atp-header {
  background: rgba(255,255,255,0.95);
  border-radius: 20px;
  padding: 10px 10px;
  box-shadow: 0 20px 40px rgba(0,0,0,0.08);
  margin-bottom: 30px;
  text-align: center;
}

.atp-icon {
  font-size: 4rem;
  color: #198754;
}

.atp-title {
  font-size: 2.6rem;
  font-weight: 700;
  color: #0d6efd;
}

.atp-subtitle {
  font-size: 1.1rem;
  color: #555;
  line-height: 1.7;
}

.badge-year {
  background-color: #198754;
  font-size: 0.9rem;
  padding: 8px 16px;
  border-radius: 50px;
}
</style>
</head>

<body class="p-4">

<div class="container">

  <!-- ================= HEADER ATP ================= -->
  <div class="atp-header">
    <div class="atp-icon mb-3">
      <i class="bi bi-mortarboard-fill"></i>
    </div>

    <div class="atp-title">
      ATP ‚Äì Annual Training Program
    </div>

    <div class="mt-3">
      <span class="badge badge-year">
        <i class="bi bi-calendar-event-fill"></i> Tahun 2026
      </span>
    </div>

    <p class="atp-subtitle mt-4">
      Rencana pelatihan tahunan yang komprehensif untuk Tahun 2026
      oleh <strong>Divisi HCC Unit Development</strong>,
      sebagai fondasi strategis pengembangan kompetensi,
      kepemimpinan, dan kapabilitas SDM secara berkelanjutan.
    </p>
  </div>
  <!-- ================= END HEADER ATP ================= -->



<div class="container">
  <div class="card shadow p-4">
    <h4 class="mb-3">üìã Data Rencana Pelatihan 2026</h4>

    <div class="row mb-3">
      <div class="col-md-3">
        <select id="filterBulan" class="form-select">
          <option value="">Semua Bulan</option>
          <option>Januari</option>
          <option>Februari</option>
          <option>Maret</option>
          <option>April</option>
          <option>Mei</option>
          <option>Juni</option>
          <option>Juli</option>
          <option>Agustus</option>
          <option>September</option>
          <option>Oktober</option>
          <option>November</option>
          <option>Desember</option>
        </select>
      </div>
      <div class="col-md-9 text-end">
        <button class="btn btn-primary" onclick="openForm()">‚ûï Tambah</button>
        <button class="btn btn-secondary" onclick="printTable()">üñ® Print</button>
      </div>
    </div>

    <div class="table-responsive">
      <table class="table table-bordered table-striped" id="dataTable">
        <thead class="table-dark">
          <tr>
            <th>Bulan</th>
            <th>Week</th>
            <th>Pelatihan</th>
            <th>Metode</th>
            <th>Trainer</th>
            <th>Peserta</th>
            <th>Biaya</th>
            <th>Realisasi</th>
            <th>Aksi</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>
</div>

<!-- MODAL -->
<div class="modal fade" id="formModal">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5>Form Pelatihan</h5>
      </div>
      <div class="modal-body">
        <input type="hidden" id="rowId">
        <div class="row g-2">
          <div class="col"><input id="bulan" class="form-control" placeholder="Bulan"></div>
          <div class="col"><input id="week" class="form-control" placeholder="Week"></div>
          <div class="col-12"><input id="nama" class="form-control" placeholder="Nama Pelatihan"></div>
          <div class="col"><input id="metode" class="form-control" placeholder="Metode"></div>
          <div class="col"><input id="trainer" class="form-control" placeholder="Trainer"></div>
          <div class="col"><input id="peserta" class="form-control" placeholder="Peserta"></div>
          <div class="col-12"><input id="biaya" type="number" class="form-control" placeholder="Biaya"></div>
          <div class="col"><input id="realisasi" class="form-control" placeholder="Realisasi"></div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-success" onclick="saveData()">üíæ Simpan</button>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbywOrlIhNwlnnkcquecWxcGh5B9jcYB2DYbGEcVms4r5JnoOWF28cZxuOFw6D27uC75lw/exec";

document.addEventListener("DOMContentLoaded", () => {
  modal = new bootstrap.Modal(document.getElementById("formModal"));
  loadData();
});

function loadData() {
  const bulan = filterBulan.value;
  fetch(API_URL + (bulan ? "?bulan="+encodeURIComponent(bulan) : ""))
    .then(r => r.json())
    .then(data => {
      const tbody = document.querySelector("#dataTable tbody");
      tbody.innerHTML = "";
      data.forEach(d => {
        tbody.innerHTML += `
          <tr>
            <td>${d.bulan}</td>
            <td>${d.week}</td>
            <td>${d.nama_pelatihan}</td>
            <td>${d.metode}</td>
            <td>${d.trainer}</td>
            <td>${d.peserta}</td>
            <td>Rp ${Number(d.biaya).toLocaleString("id-ID")}</td>
            <td>${d.realisasi}</td>
            <td>
              <button class="btn btn-sm btn-warning"
                onclick='editData(${JSON.stringify(d)})'>‚úè</button>
              <button class="btn btn-sm btn-danger"
                onclick='deleteData(${d.id})'>üóë</button>
            </td>
          </tr>`;
      });
    });
}

function saveData() {
  fetch(API_URL, {
    method:"POST",
    body: JSON.stringify({
      action: rowId.value ? "edit" : "add",
      id: rowId.value,
      bulan: bulan.value,
      week: week.value,
      nama_pelatihan: nama.value,
      metode: metode.value,
      trainer: trainer.value,
      peserta: peserta.value,
      biaya: Number(biaya.value || 0),
      realisasi:realisasi.value,
     

    })
  }).then(() => {
    modal.hide();
    loadData();
  });
}


/* =========================
   FORM
========================= */
function openForm() {
  document.querySelectorAll("#formModal input").forEach(i => i.value = "");
  rowId.value = "";
  modal.show();
}

function editData(d) {
  rowId.value = d.id;
  bulan.value = d.bulan;
  week.value = d.week;
  nama.value = d.nama_pelatihan;
  metode.value = d.metode;
  trainer.value = d.trainer;
  peserta.value = d.peserta;
  biaya.value = Number(d.biaya || 0);
  realisasi.value =d.realisasi
  

  modal.show();
}


/* =========================
   DELETE
========================= */
function deleteData(id) {
  if (!confirm("Hapus data ini?")) return;

  fetch(API_URL, {
    method: "POST",
    body: JSON.stringify({ action: "delete", id })
  }).then(loadData);
}

/* =========================
   PRINT
========================= */
function printTable() {
  const w = window.open("");
  w.document.write(`
    <html>
    <head>
      <title>Print Data</title>
      <style>
        table{width:100%;border-collapse:collapse}
        th,td{border:1px solid #000;padding:6px;font-size:12px}
      </style>
    </head>
    <body>${dataTable.outerHTML}</body>
    </html>
  `);
  w.document.close();
  w.print();
}

filterBulan.onchange = loadData;
</script>

</body>
</html>
